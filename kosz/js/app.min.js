(()=>{"use strict";let e=!1;setTimeout((()=>{if(e){let e=new Event("windowScroll");window.addEventListener("scroll",(function(t){document.dispatchEvent(e)}))}}),0);const t=document.querySelector(".cart__items"),n=document.querySelector(".cart__total-price"),c=document.querySelector(".cart"),o=document.querySelector(".cart__icon"),a=document.querySelectorAll(".add-cart"),r=document.querySelector(".cart__checkout-btn"),d=document.getElementById("paymentForm"),i=document.getElementById("visa-mastercard"),l=document.getElementById("google-pay"),s=document.querySelector(".btn");function u(){const e=document.getElementById("cardNumber"),t=document.getElementById("cardName"),n=document.getElementById("expiryDate"),c=document.getElementById("cvv");if(!(e&&t&&n&&c))return!1;const o=e.value,a=t.value,r=n.value,d=c.value;return""!==o.trim()&&""!==a.trim()&&""!==r.trim()&&""!==d.trim()}r.addEventListener("click",(function(e){i.checked||l.checked||(e.preventDefault(),alert("Please select a payment method."))})),d.addEventListener("submit",(function(e){e.preventDefault(),i.checked||l.checked?!i.checked||u()?y(f):alert("Please fill in all card details."):alert("Please select a payment method.")}));const m=document.querySelector(".btn.payment-methods__button");function y(e){i.checked||l.checked?fetch("https://httpbin.org/post",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({products:e})}).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((e=>{console.log("Server response:",e)})).catch((e=>{console.error("There was a problem with your fetch operation:",e)})):console.log("No payment method selected.")}m.addEventListener("click",(function(e){if(e.preventDefault(),u()){const e={cardNumber:document.getElementById("cardNumber").value,cardName:document.getElementById("cardName").value,expiryDate:document.getElementById("expiryDate").value,cvv:document.getElementById("cvv").value};savedCards.push(e),m.disabled=!0,y(e)}else alert("Please fill in all card details correctly.")}));const p=document.getElementById("visa-mastercard");let g=!1;function v(e){const t=document.getElementById("cardDetails");t.contains(e.target)||e.target===p||(t.style.display="none",document.removeEventListener("click",v),g=!1)}p.addEventListener("click",(function(){const e=document.getElementById("cardDetails");g?p.checked||(e.style.display="none",document.removeEventListener("click",v),g=!1):(e.style.display="block",g=!0,document.addEventListener("click",v))})),s.addEventListener("click",(e=>{e.target!==s&&e.stopPropagation()}));let f=[];const E=document.getElementById("checkoutForm"),_=document.getElementById("delivery-address"),h=document.getElementById("delivery-address-info"),b=document.getElementById("edit-address-button");let k;function q(e){const t=e.target.closest(".product"),n=t.querySelector(".product__title").textContent,c=f.find((e=>e.title===n));if(c)c.quantity+=1;else{const e=t.querySelector(".product__image").src,c=t.querySelector(".product__price").textContent,o={image:e,title:n,price:c,quantity:1};f.push(o)}localStorage.setItem("cart",JSON.stringify(f)),L(),y(t),S()}function S(){const e=document.querySelector(".cart__icon"),t=f.reduce(((e,t)=>e+t.quantity),0);let n=e.querySelector(".cart__item-count");n||(n=document.createElement("span"),n.classList.add("cart__item-count"),e.appendChild(n)),n.textContent=t,t>0?e.classList.add("non-empty-cart"):e.classList.remove("non-empty-cart")}function I(e){f.splice(e,1),localStorage.setItem("cart",JSON.stringify(f)),L(),S()}function L(){t.innerHTML="";let e=0;f.forEach(((n,c)=>{const o=document.createElement("div");o.classList.add("cart__item"),o.innerHTML=`\n            <img class="cart__item-image" src="${n.image}" alt="Product Image">\n            <div class="cart__item-details">\n                <h3 class="cart__item-title">${n.title}</h3>\n                <span class="cart__item-price">${n.price}</span>\n                <button class="cart__item-remove" data-index="${c}"></button>  \n            </div>\n            <div class="cart__item-quantity">\n                <button class="quantity-button quantity-button--decrease">-</button>\n                <span class="quantity-value">${n.quantity}</span>\n                <button class="quantity-button quantity-button--increase">+</button>\n            </div>\n        `;o.querySelector(".cart__item-remove").addEventListener("click",(()=>{I(c)})),t.appendChild(o),e+=parseFloat(n.price.replace("$",""))*n.quantity})),n.textContent=`$${e.toFixed(2)}`;document.querySelectorAll(".quantity-button--increase").forEach((e=>{e.addEventListener("click",(()=>{A(parseInt(e.closest(".cart__item").querySelector(".cart__item-remove").getAttribute("data-index")),1)}))}));document.querySelectorAll(".quantity-button--decrease").forEach((e=>{e.addEventListener("click",(()=>{A(parseInt(e.closest(".cart__item").querySelector(".cart__item-remove").getAttribute("data-index")),-1)}))}))}function A(e,t){f[e]&&f[e].quantity&&(f[e].quantity+=t,f[e].quantity<1?I(e):L())}E.addEventListener("submit",(function(e){e.preventDefault(),k=new FormData(E),function(e){const t=e.get("firstName"),n=e.get("lastName"),c=e.get("address"),o=e.get("apartment"),a=e.get("postalCode"),r=e.get("city"),d=e.get("phoneNumber"),i=`${t}  ${n}<br>${c},<br>${o?o+",<br>":""}${a} ${r},<br>${d}`;h.innerHTML=i,_.style.display="flex"}(k)})),b.addEventListener("click",(function(){document.querySelectorAll(".checkoutForm__info").forEach((e=>{const t=e.getAttribute("name"),n=k.get(t);e.value=n}));document.querySelector(".checkoutForm__info").focus()})),a.forEach((e=>{e.addEventListener("click",q)})),r.addEventListener("click",(()=>{y(f)})),window.addEventListener("DOMContentLoaded",(()=>{f=JSON.parse(localStorage.getItem("cart"))||[],L()})),o.addEventListener("click",(function(){c.classList.toggle("show-cart")}));const B=document.getElementById("toggleAddressForm"),w=document.getElementById("checkoutForm");w.style.display="none",B.addEventListener("click",(function(){"none"===w.style.display||""===w.style.display?(w.style.display="block",B.textContent="Zamkni"):(w.style.display="none",B.textContent="Dodaj Adres")})),window.FLS=!0,function(e){let t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}((function(e){let t=!0===e?"webp":"no-webp";document.documentElement.classList.add(t)}))})();