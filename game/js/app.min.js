(()=>{"use strict";let t=!1;setTimeout((()=>{if(t){let t=new Event("windowScroll");window.addEventListener("scroll",(function(e){document.dispatchEvent(t)}))}}),0),document.addEventListener("DOMContentLoaded",(function(){const t=document.getElementById("pachinkoBoard"),e=document.getElementById("movingBlock"),o=document.getElementById("ball"),s=document.getElementById("prizeDisplay"),i=document.getElementById("dropBallButton"),n=document.getElementById("jackpotSound"),l=document.getElementById("ballSound"),a=document.getElementById("pointSound"),d=document.getElementById("shortSound"),c=document.getElementById("msg"),f=document.getElementById("win");let r=!1,m=0,p=0;const u=3,y=1500;function h(){let e;e=window.innerWidth<=991?450:560;for(let o=55,s=1;o<e;o+=55,s++){for(let e=s%2==0?25:50;e<295;e+=50){const s=document.createElement("div");s.classList.add("peg"),s.style.left=`${e}px`,s.style.top=`${o}px`,t.appendChild(s)}}}function g(l){const c=[30,47,47,47,47,47,30];let r=0;switch(c.map(((t,e)=>c.slice(0,e).reduce(((t,e)=>t+e),0))).findIndex(((t,e)=>l>=t&&l<t+c[e]))){case 0:case 6:r=100,s.textContent="Prize: 100 points";break;case 1:case 5:r=250,s.textContent="Prize: 250 points";break;case 2:case 4:r=500,s.textContent="Prize: 500 points";break;case 3:r=1e3,s.textContent="Prize: 1000 points";break;default:s.textContent="Prize: No points"}!function(e,o){const s=document.createElement("div");s.classList.add("floating-number"),s.textContent=e;let i=o;i<0?i=0:i>t.clientWidth-30&&(i=t.clientWidth-30),s.style.left=`${i}px`,s.style.top=t.clientHeight-50+"px",t.appendChild(s),a.play(),setTimeout((()=>{s.remove(),a.pause(),a.currentTime=0}),1500)}(r,l),p+=r,m++,m>=u?(p>=y?(s.textContent=`Jackpot! Total points: ${p}`,t.classList.add("jackpot"),s.classList.add("jackpot-text"),f.classList.add("win"),n.play(),setTimeout((()=>{t.classList.remove("jackpot"),v()}),4e3),setTimeout((()=>{s.classList.remove("jackpot-text"),v()}),17e3),setTimeout((()=>{f.classList.remove("win"),v()}),17e3),setTimeout((()=>{document.querySelectorAll(".peg").forEach((t=>{t.classList.remove("sequential-flash"),t.style.animationDelay=""}))}),17e3),i.disabled=!0,setTimeout((()=>{i.disabled=!1}),17e3)):(s.textContent=`Total points: ${p}`,d.play(),setTimeout((()=>{d.pause(),d.currentTime=0}),4e3)),m=0,p=0):s.textContent+=` | Total points: ${p}`,setTimeout((()=>{o.style.top=`${e.offsetTop+e.offsetHeight}px`,o.style.left=e.offsetLeft+e.offsetWidth/2-o.offsetWidth/2+"px",o.style.visibility="visible"}),500)}function v(){document.querySelectorAll(".peg").forEach(((t,e)=>{t.style.animationDelay=.1*e+"s",t.classList.add("sequential-flash")}))}h(),c.addEventListener("click",(()=>{o.style.transition="left 0.01s"})),i.addEventListener("click",(function(){if(r)return;r=!0,l.play(),o.style.visibility="visible";let s=e.offsetTop+e.offsetHeight,i=e.offsetLeft+e.offsetWidth/2-o.offsetWidth/2,n=0;o.style.top=`${s}px`,o.style.left=`${i}px`;let a=!1;const d=setInterval((()=>{s+=4.1,s>=t.clientHeight-o.offsetHeight&&(s=t.clientHeight-o.offsetHeight),o.style.top=`${s}px`,document.querySelectorAll(".peg").forEach((e=>{const s=e.getBoundingClientRect(),l=o.getBoundingClientRect();if(l.bottom>s.top&&l.top<s.bottom&&l.left<s.right&&l.right>s.left&&!a){const s=.5,l=20,d=(s-l)/(s+l)*16+2*l/(s+l)*0,c=Math.random()<.5?-1.55:1.55;i=Math.min(Math.max(i+d*c,0),t.clientWidth-o.offsetWidth),n+=(640*Math.random()+180)*c,o.style.transition="left 0.08s, transform 1.3s ease-out",o.style.left=`${i}px`,o.style.transform=`rotate(${n}deg)`,a=!0,setTimeout((()=>a=!1),360),e.classList.add("collision"),setTimeout((()=>{e.classList.remove("collision")}),300)}})),s>=t.clientHeight-o.offsetHeight&&(clearInterval(d),l.pause(),l.currentTime=0,g(i),o.style.transition="",setTimeout((()=>{o.style.opacity=0,o.style.visibility="hidden",o.style.transform="rotate(0deg)",setTimeout((()=>{r=!1}),1700)}),100),setTimeout((()=>{o.style.opacity=1}),1900))}),45)})),o.style.top=`${e.offsetTop+e.offsetHeight}px`,o.style.left=e.offsetLeft+e.offsetWidth/2-o.offsetWidth/2+"px",o.style.visibility="visible",function(){const t=()=>{r||(o.style.top=`${e.offsetTop+e.offsetHeight}px`,o.style.left=e.offsetLeft+e.offsetWidth/2-o.offsetWidth/2+"px",o.style.visibility="visible")};setInterval(t,10)}(),window.addEventListener("resize",(()=>{document.querySelectorAll(".peg").forEach((t=>t.remove())),h()}))}))})();